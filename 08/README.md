# Webサーバの負荷分散(ELB)

Webサーバの負荷分散を行うELBについて書かれています

## ELBって何
- ELB : _Elastic Load Balancing_
- AWSが提供しているロードバランシングサービス
    - サーバの負荷が高まった際にトラッフィクに合わせてインスタンスへのアクセスを分散させる
![image](https://user-images.githubusercontent.com/12966452/34437484-0206f508-ece2-11e7-9508-8e7fc5a125e7.png)

### 特徴
- リージョン毎の構成
    - ELBはどこか1つのリージョンに属する
- アベイラビリティゾーンをまたがる構成
    - アベイラビリティゾーンをまたがるような冗長構成にできるため、高い耐障害性を持つ。
- ELB自身のスケールアウト/スケールイン
    - トラッフィクに合わせて自動的に拡張・縮小を行う！

### ELBの構築について
1. ELBを作成
1. セキュリティグループの設定、ヘルスチェックの設定を行う
1. ELB配下に置くEC2インスタンスを選択


## ELB運用でのポイント
#### Cookieによる維持設定
- サーバのロードバランシングをする祭、セッション情報の維持の仕方が重要
- セッション情報が各サーバのローカルで管理されている場合、サーバが変更されるとアクセスできなくなる。
- そのような状況に対応するために、ELBでは最初に負荷分散されたサーバに2回目移行のアクセスも固定する機能がある
![image](https://user-images.githubusercontent.com/12966452/34437905-ece0dde8-ece5-11e7-9e83-244f3978994a.png)

#### 暖機運転
- 突発的な負荷上昇の場合、スケールアウトが間に合わない可能性がある
- そのような状況に対応するために、事前に想定したトラッフィクをかけてELBをスケールアウトさせておく（暖機運転）

## 知見
- ELBは使ったことがあったので、設定は非常に簡単に出来た
- ヘルスチェックや暖機運転など知らなかった機能や運用でのポイントを知ることが出来勉強になった
- 運用では必須のサービスだと思うので忘れずに使っていきたい。